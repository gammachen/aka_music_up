
## 1. 产品概述

- **产品名称**：音乐站点  
- **产品目标**：为用户提供一个音乐交流平台，支持用户注册、登录、发布主题、回复主题、充值、开通 VIP 等功能，提升用户互动体验。  
- **目标用户**：音乐爱好者、社区用户、内容创作者。  
- **核心功能**：用户注册与登录、用户信息管理、充值、开通 VIP、主题发布与回复、点赞与收藏、打赏等。  

---

## 2. 核心模块设计

### 2.1 用户注册

- **功能描述**：支持多种注册方式，包括用户名+密码、手机号+验证码、邮箱+验证码。  
- **需求细节**：  
  - 用户名需唯一，长度限制为 3-20 个字符。  
  - 密码需加密存储，长度限制为 8-20 个字符，需包含字母和数字。  
  - 手机号和邮箱需验证有效性。  
  - 注册成功后自动登录并跳转到首页。  

### 2.2 用户登录

- **功能描述**：支持用户名+密码、手机号+验证码、邮箱+验证码登录。  
- **需求细节**：  
  - 登录失败时提示具体原因（如用户名不存在、密码错误等）。  
  - 登录成功后跳转到首页。  

### 2.3 用户信息

- **功能描述**：展示用户基本信息及统计数据。  
- **需求细节**：  
  - 用户名、头像、创建时间、主题数、回复主题数、金币数量、积分/经验值/成长值。  
  - 支持用户修改头像和用户名（用户名修改需唯一性校验）。  

### 2.4 充值

- **功能描述**：支持用户充值金币，提供支付宝和微信支付方式。  
- **需求细节**：  
  - 充值金额与金币比例：  
    - 小于 10 元：1 元 = 10 金币。  
    - 大于等于 10 元：1 元 = 11 金币。  
  - 充值成功后更新用户金币数量，并发送通知。  

### 2.5 开通 VIP

- **功能描述**：用户可通过支付金币开通 VIP，享受特权。  
- **需求细节**：  
  - 开通规则：一次性支付 1000 金币或 1000 的 n 倍数金币，获得 1 年或 n 年 VIP 特权。  
  - VIP 特权：  
    - 免回复查看隐藏内容。  
    - 回复不扣金币。  
  - VIP 有效期结束后自动降级为普通用户。  

### 2.6 用户登出

- **功能描述**：用户登出后跳转到首页。  
- **需求细节**：  
  - 登出后清除用户会话信息。  

### 2.7 首页与目录页

- **功能描述**：展示最新热门主题列表及辅助信息。  
- **需求细节**：  
  - 顶部目录导航：分类、登录/登出入口。  
  - 左侧主体：最新热门主题列表（分页展示）。  
  - 右侧：发帖入口、推荐信息、辅助信息（如热门用户、活动公告等）。  

### 2.8 主题详情页

- **功能描述**：展示主题详细内容，支持不同用户权限的展示逻辑。  
- **需求细节**：  
  - 游客：仅展示公开内容，隐藏内容需提示登录或开通 VIP。  
  - 普通用户：需回复主题后才能查看隐藏内容。  
  - VIP 用户：可直接查看隐藏内容。  

### 2.9 回复主题

- **功能描述**：支持用户回复主题，并展示回复列表。  
- **需求细节**：  
  - 回复列表分页展示，每页 20 条。  
  - 回复成功后刷新回复列表。  
  - 普通用户回复主题需扣除 1 金币，VIP 用户不扣金币。  

### 2.10 点赞与收藏

- **功能描述**：支持用户点赞和收藏主题。  
- **需求细节**：  
  - 点赞：用户可对主题点赞，点赞数实时更新。  
  - 收藏：用户可收藏主题，收藏列表可在个人中心查看。  

### 2.11 打赏主题

- **功能描述**：支持用户打赏主题作者。  
- **需求细节**：  
  - 打赏金额需使用金币，打赏成功后扣除用户金币并增加作者金币。  

### 2.12 发布主题

- **功能描述**：支持用户发布主题，使用富文本编辑器。  
- **需求细节**：  
  - 富文本编辑器支持文字、图片、视频等内容。  
  - 支持设置隐藏内容，隐藏内容需满足特定条件（如回复或 VIP）才能查看。  

---

## 3. 核心模型设计

### 3.1 用户（User）

- **字段**：用户 ID、用户名、密码（加密）、手机号、邮箱、头像、创建时间、金币数量、积分/经验值/成长值、VIP 有效期、是否 Admin。  
- **说明**：支持用户名+密码、手机号、第三方登录，密码需加密存储。  

### 3.2 主题（Topic）

- **字段**：主题 ID、标题、内容、作者 ID、分类 ID、创建时间、点赞数、收藏数、打赏总额、隐藏内容。  
- **说明**：主题内容支持富文本，隐藏内容需满足特定条件才能查看。  

### 3.3 主题回复（Topic_Comment）

- **字段**：回复 ID、主题 ID、用户 ID、内容、创建时间。  
- **说明**：回复内容支持文本，普通用户回复需扣除金币。  

### 3.4 用户收藏（User_Collections）

- **字段**：收藏 ID、用户 ID、主题 ID、创建时间。  

### 3.5 用户点赞（User_Likes）

- **字段**：点赞 ID、用户 ID、主题 ID、创建时间。  

### 3.6 内容点赞信息（Likes_Count）

- **字段**：主题 ID、点赞数。  

### 3.7 用户金币（User_Money）

- **字段**：用户 ID、金币数量。  

### 3.8 用户积分（User_Score）

- **字段**：用户 ID、积分/经验值/成长值。  

### 3.9 分类（Category）

- **字段**：分类 ID、分类名称。  

### 3.10 用户特权规则（User_Special_Rule）

- **字段**：规则 ID、规则名称、规则描述（如 VIP 特权）。  

---

## 4. 特殊说明

1. **用户密码加密**：使用 SHA-256 加密算法存储用户密码。  
2. **Admin 用户**：支持 Admin 用户管理站点内容（如删除主题、封禁用户等）。  
3. **VIP 特权**：VIP 特权与用户积分关联，可定义规则（如积分达到 1000 分自动升级为 VIP）。  
4. **VIP 有效期**：VIP 特权有时间限制，到期后自动降级为普通用户。  

---

## 5. 非功能性需求

1. **性能**：首页加载时间不超过 2 秒，主题详情页加载时间不超过 3 秒。  
2. **安全性**：用户密码需加密存储，防止 SQL 注入和 XSS 攻击。  
3. **兼容性**：支持主流浏览器（Chrome、Firefox、Safari）和移动端访问。  

---

## 6. 后续规划

1. 增加音乐播放功能，支持用户上传和分享音乐。  
2. 引入社交功能，支持用户关注、私信等互动。  
3. 优化推荐算法，根据用户兴趣推荐主题和音乐。 

