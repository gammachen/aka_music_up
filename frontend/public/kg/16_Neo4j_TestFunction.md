åœ¨ Neo4j ä¸­ï¼Œ`apoc.date.parse()` æ˜¯ APOCï¼ˆAwesome Procedures On Cypherï¼‰åº“æä¾›çš„ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„æ—¥æœŸ/æ—¶é—´å¤„ç†å‡½æ•°ï¼Œç”¨äºå°†å­—ç¬¦ä¸²è§£æä¸ºæ—¶é—´æˆ³ï¼ˆä»¥æ¯«ç§’æˆ–ç§’ä¸ºå•ä½ï¼‰ã€‚

è¡¨è¾¾å¼ï¼š

```cypher
apoc.date.parse('2018-01-01', 's', 'yyyy-MM-dd')
```

æ˜¯ä¸€ä¸ªå…¸å‹çš„ä½¿ç”¨æ–¹å¼ã€‚ä¸‹é¢æˆ‘æ¥è¯¦ç»†è§£é‡Šè¿™ä¸ªå‡½æ•°çš„ä½œç”¨ã€å‚æ•°å«ä¹‰ï¼Œå¹¶é€šè¿‡ç¤ºä¾‹æ¼”ç¤ºå®ƒçš„ç”¨æ³•å’Œæ•ˆæœã€‚

---

## âœ… ä¸€ã€`apoc.date.parse()` å‡½æ•°è¯´æ˜

### ğŸ“Œ å‡½æ•°åŸå‹ï¼š
```java
apoc.date.parse(text, unit, format)
```

### ğŸ”§ å‚æ•°è¯´æ˜ï¼š

| å‚æ•° | ç±»å‹ | æè¿° |
|------|------|------|
| `text` | String | è¦è§£æçš„æ—¶é—´å­—ç¬¦ä¸²ï¼Œå¦‚ `'2018-01-01'` |
| `unit` | String | è¾“å‡ºçš„æ—¶é—´å•ä½ï¼š`ms`ï¼ˆæ¯«ç§’ï¼‰æˆ– `s`ï¼ˆç§’ï¼‰ï¼Œé»˜è®¤æ˜¯ `ms` |
| `format` | String | æ—¶é—´æ ¼å¼å­—ç¬¦ä¸²ï¼Œéµå¾ª Java çš„ `SimpleDateFormat` æ ¼å¼ |

---

## âœ… äºŒã€ä½ çš„ä¾‹å­è¯¦è§£

```cypher
apoc.date.parse('2018-01-01', 's', 'yyyy-MM-dd')
```

### ğŸ§  è§£æé€»è¾‘ï¼š

- è¾“å…¥å­—ç¬¦ä¸²ï¼š`'2018-01-01'`
- æŒ‡å®šæ ¼å¼ï¼š`yyyy-MM-dd`
- è¾“å‡ºå•ä½ï¼š`s`ï¼ˆå³è¿”å›çš„æ˜¯ç§’çº§æ—¶é—´æˆ³ï¼‰

### ğŸ“Œ ç»“æœç­‰ä»·äº Java ä¸­çš„ï¼š

```java
SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd");
Date date = sdf.parse("2018-01-01");
long timestampInSeconds = date.getTime() / 1000;
```

---

## âœ… ä¸‰ã€å®é™…æµ‹è¯•è¯­å¥ï¼ˆNeo4j Browserï¼‰

ä½ å¯ä»¥è¿è¡Œä»¥ä¸‹ Cypher æŸ¥è¯¢æ¥æŸ¥çœ‹ç»“æœï¼š

```cypher
RETURN apoc.date.parse('2018-01-01', 's', 'yyyy-MM-dd') AS timestamp;
```

### ğŸ” ç¤ºä¾‹è¾“å‡ºï¼ˆåŸºäº GMT+0ï¼‰ï¼š

```
timestamp: 1514764800
```

> è¿™ä¸ªæ•°å­—è¡¨ç¤ºä» **1970-01-01 00:00:00 UTC** åˆ° **2018-01-01 00:00:00 UTC** æ‰€ç»è¿‡çš„ç§’æ•°ã€‚

---

## âœ… å››ã€è½¬æ¢ä¸ºå¯è¯»æ—¥æœŸæ ¼å¼ï¼ˆéªŒè¯ï¼‰

ä½ å¯ä»¥ç”¨ `apoc.date.format()` æ¥éªŒè¯æ˜¯å¦æ­£ç¡®è§£æï¼š

```cypher
WITH apoc.date.parse('2018-01-01', 'ms', 'yyyy-MM-dd') AS millis
RETURN apoc.date.format(millis, 'ms', 'yyyy-MM-dd HH:mm:ss') AS formattedDate;
```

### âœ… è¾“å‡ºåº”ä¸ºï¼š

```
formattedDate: "2018-01-01 00:00:00"
```

---

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **æ ¼å¼å¿…é¡»åŒ¹é…è¾“å…¥å­—ç¬¦ä¸²**  
   å¦‚æœä½ å†™æˆ `'yyyy/MM/dd'` å»è§£æ `'2018-01-01'`ï¼Œä¼šæŠ¥é”™æˆ–è¿”å› `null`ã€‚

2. **æ—¶åŒºé—®é¢˜ï¼ˆé»˜è®¤æ˜¯ç³»ç»Ÿæ—¶åŒºï¼‰**  
   APOC çš„æ—¥æœŸå‡½æ•°é»˜è®¤ä½¿ç”¨æœåŠ¡å™¨æ‰€åœ¨çš„æ—¶åŒºã€‚å¦‚æœä½ éœ€è¦æŒ‡å®šæ—¶åŒºï¼Œå¯ä»¥ä½¿ç”¨é¢å¤–å‚æ•°ï¼ˆæŸäº›ç‰ˆæœ¬æ”¯æŒï¼‰ï¼š
   ```cypher
   apoc.date.parse('2018-01-01', 's', 'yyyy-MM-dd', 'GMT+8')
   ```

3. **ç¡®ä¿ APOC å·²å¯ç”¨**
   - å®‰è£…äº† APOC æ’ä»¶
   - é…ç½®ä¸­åŠ å…¥äº†ï¼š
     ```
     dbms.security.procedures.unrestricted=apoc.*
     ```

---

## âœ… äº”ã€å®Œæ•´å°ä¾‹å­

```cypher
// è§£æå­—ç¬¦ä¸²å¹¶æ ¼å¼åŒ–è¾“å‡º
WITH apoc.date.parse('2025-04-05', 'ms', 'yyyy-MM-dd') AS millis
RETURN 
  millis,
  apoc.date.fromEpoch(millis / 1000) AS dateNode, -- è¿”å› Date ç±»å‹èŠ‚ç‚¹ï¼ˆå¦‚æœæ”¯æŒï¼‰
  apoc.date.format(millis, 'ms', 'yyyy-MM-dd HH:mm:ss') AS readable;
```

---

## ğŸ“Œ æ€»ç»“

| è¡¨è¾¾å¼ | å«ä¹‰ |
|--------|------|
| `apoc.date.parse('2018-01-01', 's', 'yyyy-MM-dd')` | å°† `'2018-01-01'` æŒ‰ç…§è¯¥æ ¼å¼è§£æä¸ºç§’çº§æ—¶é—´æˆ³ |
| `apoc.date.format(...)` | å¯ç”¨äºåå‘æ“ä½œï¼Œå°†æ—¶é—´æˆ³æ ¼å¼åŒ–ä¸ºå¯è¯»å­—ç¬¦ä¸² |
| `apoc.date.fromEpoch(...)` | å°†æ—¶é—´æˆ³è½¬ä¸ºå›¾æ•°æ®åº“ä¸­çš„ `Date` ç±»å‹èŠ‚ç‚¹ï¼ˆéƒ¨åˆ†ç‰ˆæœ¬æ”¯æŒï¼‰ |

---
