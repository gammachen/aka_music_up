为了在项目中增加干系人（Stakeholder）相关的图谱信息，使干系人之间的关系更加直观可视化和可统计分析，需要在现有模型基础上增加关键元素：

---

### 需要新增的数据模型元素（使用 PM_ 前缀）

#### 1. **干系人节点类型**
```cypher
(:PM_Stakeholder {
  id: "UUID",
  name: "姓名",
  role: "角色", // 如：客户代表、产品经理、供应商、最终用户等
  type: "内部|外部", 
  influence: "高|中|低", // 影响力级别
  interest: "高|中|低",  // 关注度级别
  department: "部门",
  contact: "联系方式"
})
```

#### 2. **干系人关系类型**
```cypher
// 干系人之间的直接关系
(:PM_Stakeholder)-[:REPORTS_TO]->(:PM_Stakeholder)  // 汇报关系
(:PM_Stakeholder)-[:COLLABORATES_WITH]->(:PM_Stakeholder) // 合作关系
(:PM_Stakeholder)-[:INFLUENCES]->(:PM_Stakeholder)  // 影响关系

// 干系人与项目元素的关系
(:PM_Stakeholder)-[:INTERESTED_IN]->(:PM_Task|:PM_Bug) // 关注特定任务/Bug
(:PM_Stakeholder)-[:RESPONSIBLE_FOR]->(:PM_Task) // 对任务负责
(:PM_Stakeholder)-[:DECISION_MAKER_FOR]->(:PM_Project) // 项目决策者
(:PM_Stakeholder)-[:CONTACT_PERSON_FOR]->(:PM_Staff) // 团队联系人
```

#### 3. **干系人分组节点**
```cypher
(:PM_StakeholderGroup {
  id: "UUID",
  name: "组名", // 如：客户团队、管理层、供应商代表
  type: "内部|外部"
})
```

---

### 扩展后的完整数据模型示意图

```
[PM_Project] 
   ├── HAS_MAIN_TASK ── [PM_Task]
   ├── HAS_STAKEHOLDER ─ [PM_Stakeholder]
   └── HAS_GROUP ─── [PM_StakeholderGroup]

[PM_Stakeholder]
   ├── MEMBER_OF ── [PM_StakeholderGroup]
   ├── REPORTS_TO ─ [PM_Stakeholder]
   ├── INTERESTED_IN ─ [PM_Task]
   └── COLLABORATES_WITH ─ [PM_Stakeholder]

[PM_Staff]
   └── CONTACT_PERSON_FOR ─ [PM_Stakeholder]
```

---

### 增强版初始化脚本（增加干系人相关数据）

```cypher
// ===== 1. 创建干系人组 =====
CREATE 
  (clientGroup:PM_StakeholderGroup {id: "group_001", name: "客户团队", type: "外部"}),
  (execGroup:PM_StakeholderGroup {id: "group_002", name: "管理层", type: "内部"}),
  (vendorGroup:PM_StakeholderGroup {id: "group_003", name: "供应商代表", type: "外部"});

// ===== 2. 创建干系人 =====
CREATE 
  (sh1:PM_Stakeholder {id: "sh_001", name: "王总", role: "客户决策人", type: "外部", influence: "高", interest: "高", department: "管理层", contact: "wang@client.com"}),
  (sh2:PM_Stakeholder {id: "sh_002", name: "李经理", role: "客户项目经理", type: "外部", influence: "中", interest: "高", department: "IT部", contact: "li@client.com"}),
  (sh3:PM_Stakeholder {id: "sh_003", name: "张总监", role: "执行总监", type: "内部", influence: "高", interest: "中", department: "管理层", contact: "zhang@company.com"}),
  (sh4:PM_Stakeholder {id: "sh_004", name: "刘代表", role: "供应商接口人", type: "外部", influence: "中", interest: "中", department: "合作伙伴", contact: "liu@vendor.com"}),
  (sh5:PM_Stakeholder {id: "sh_005", name: "陈主管", role: "业务负责人", type: "内部", influence: "中", interest: "高", department: "业务部", contact: "chen@company.com"});

// ===== 3. 干系人分组关系 =====
MATCH 
  (clientGroup:PM_StakeholderGroup {id: "group_001"}),
  (execGroup:PM_StakeholderGroup {id: "group_002"}),
  (vendorGroup:PM_StakeholderGroup {id: "group_003"}),
  (sh1:PM_Stakeholder {id: "sh_001"}),
  (sh2:PM_Stakeholder {id: "sh_002"}),
  (sh3:PM_Stakeholder {id: "sh_003"}),
  (sh4:PM_Stakeholder {id: "sh_004"}),
  (sh5:PM_Stakeholder {id: "sh_005"})
CREATE
  (sh1)-[:MEMBER_OF]->(clientGroup),
  (sh2)-[:MEMBER_OF]->(clientGroup),
  (sh3)-[:MEMBER_OF]->(execGroup),
  (sh4)-[:MEMBER_OF]->(vendorGroup),
  (sh5)-[:MEMBER_OF]->(execGroup);

// ===== 4. 干系人层级关系 =====
MATCH 
  (sh1:PM_Stakeholder {id: "sh_001"}),
  (sh2:PM_Stakeholder {id: "sh_002"}),
  (sh3:PM_Stakeholder {id: "sh_003"}),
  (sh5:PM_Stakeholder {id: "sh_005"})
CREATE
  (sh2)-[:REPORTS_TO]->(sh1),  // 客户项目经理汇报给客户决策人
  (sh5)-[:REPORTS_TO]->(sh3);  // 业务负责人汇报给执行总监

// ===== 5. 干系人与项目关系 =====
MATCH 
  (proj:PM_Project {id: "proj_ERP"}),
  (sh1:PM_Stakeholder {id: "sh_001"}),
  (sh2:PM_Stakeholder {id: "sh_002"}),
  (sh3:PM_Stakeholder {id: "sh_003"})
CREATE
  (sh1)-[:DECISION_MAKER_FOR]->(proj),
  (sh2)-[:INTERESTED_IN]->(proj),
  (sh3)-[:DECISION_MAKER_FOR]->(proj);

// ===== 6. 干系人与任务关系 =====
MATCH 
  (sh1:PM_Stakeholder {id: "sh_001"}),
  (sh2:PM_Stakeholder {id: "sh_002"}),
  (sh5:PM_Stakeholder {id: "sh_005"}),
  (report:PM_Task {id: "task_1003"}),       // 报表模块
  (integration:PM_Task {id: "task_1005"})   // 第三方集成
CREATE
  (sh1)-[:INTERESTED_IN {priority: "高"}]->(report),
  (sh2)-[:RESPONSIBLE_FOR]->(report),
  (sh5)-[:INTERESTED_IN]->(integration);

// ===== 7. 干系人与团队联系人关系 =====
MATCH 
  (pm:PM_Staff {id: "staff_001"}),          // 项目经理
  (ba:PM_Staff {id: "staff_401"}),          // 业务分析师
  (sh1:PM_Stakeholder {id: "sh_001"}),
  (sh2:PM_Stakeholder {id: "sh_002"}),
  (sh4:PM_Stakeholder {id: "sh_004"})
CREATE
  (pm)-[:CONTACT_PERSON_FOR]->(sh1),
  (pm)-[:CONTACT_PERSON_FOR]->(sh2),
  (ba)-[:CONTACT_PERSON_FOR]->(sh4);

// ===== 8. 干系人合作关系 =====
MATCH 
  (sh2:PM_Stakeholder {id: "sh_002"}),  // 客户项目经理
  (sh5:PM_Stakeholder {id: "sh_005"})   // 业务负责人
CREATE
  (sh2)-[:COLLABORATES_WITH {since: "2023-03-01"}]->(sh5);
```

---

### 干系人图谱分析示例查询

#### 1. 关键干系人影响力分析
```cypher
// 查找项目中的关键决策者和高影响力干系人
MATCH (s:PM_Stakeholder)-[:DECISION_MAKER_FOR]->(p:PM_Project {id: "proj_ERP"})
OPTIONAL MATCH (s)<-[:REPORTS_TO*1..3]-(subordinate)
RETURN s.name AS stakeholder, 
       s.influence AS influence,
       COUNT(DISTINCT subordinate) AS teamSize,
       COLLECT(DISTINCT subordinate.name) AS teamMembers
ORDER BY influence DESC
```

#### 2. 干系人关注点分析
```cypher
// 查看每个干系人关注的任务及状态
MATCH (s:PM_Stakeholder)-[:INTERESTED_IN]->(t:PM_Task)
WHERE EXISTS { (t)<-[:HAS_MAIN_TASK|HAS_SUBTASK]-(:PM_Project {id: "proj_ERP"}) }
RETURN s.name AS stakeholder,
       s.role AS role,
       COLLECT(t.title) AS interestedTasks,
       AVG(CASE t.status 
            WHEN '已完成' THEN 1 
            WHEN '进行中' THEN 0.5 
            ELSE 0 END) * 100 AS satisfactionIndex
ORDER BY satisfactionIndex DESC
```

#### 3. 干系人关系网络可视化
```cypher
// 获取完整的干系人关系网络（用于图可视化）
MATCH path=(s1:PM_Stakeholder)-[r:REPORTS_TO|COLLABORATES_WITH|INFLUENCES]-(s2)
WHERE EXISTS { (s1)-[:INTERESTED_IN|DECISION_MAKER_FOR]->(:PM_Project {id: "proj_ERP"}) }
  AND EXISTS { (s2)-[:INTERESTED_IN|DECISION_MAKER_FOR]->(:PM_Project {id: "proj_ERP"}) }
RETURN path
```

#### 4. 干系人沟通渠道分析
```cypher
// 分析干系人沟通路径和团队联系人
MATCH (staff:PM_Staff)-[:CONTACT_PERSON_FOR]->(stakeholder:PM_Stakeholder)
OPTIONAL MATCH (stakeholder)-[:MEMBER_OF]->(group)
RETURN staff.name AS contactPerson,
       stakeholder.name AS stakeholder,
       group.name AS stakeholderGroup,
       COUNT { (staff)-[:ASSIGNED_TO]->() } AS staffWorkload
ORDER BY staffWorkload
```

#### 5. 风险干系人识别
```cypher
// 识别高关注度但任务进展不佳的干系人
MATCH (s:PM_Stakeholder)-[:INTERESTED_IN]->(t:PM_Task)
WHERE t.status IN ["阻塞", "延迟"] AND s.interest = "高"
WITH s, COUNT(t) AS blockedCount
MATCH (s)-[:CONTACT_PERSON_FOR]-(contact:PM_Staff)
RETURN s.name AS stakeholder,
       blockedCount,
       contact.name AS contactPerson,
       contact.contact AS contactInfo
ORDER BY blockedCount DESC
```

---

### 系统实现建议

1. **干系人图谱可视化**
   - 使用 Neo4j Bloom 或 Linkurious 进行交互式可视化
   - 按干系人类型/影响力分组着色
   - 用关系线粗细表示关系强度

2. **影响度分析引擎**
   ```python
   # 伪代码：干系人影响传播算法
   def calculate_influence(node, depth=3):
       total_influence = node.influence
       for rel in graph.relationships(node, direction="OUTGOING"):
           if rel.type in ["REPORTS_TO", "INFLUENCES"]:
               neighbor = rel.end_node
               total_influence += calculate_influence(neighbor, depth-1) * 0.5
       return total_influence
   ```

3. **自动提醒机制**
   - 当干系人关注的任务状态变更时自动通知
   - 高影响力干系人关注的任务延期时升级警报

4. **关系强度分析**
   ```cypher
   // 计算干系人关系紧密度
   MATCH (s:PM_Stakeholder)
   OPTIONAL MATCH (s)-[r]-(other)
   WITH s, COUNT(r) AS degree, 
        SUM(CASE type(r) 
            WHEN 'COLLABORATES_WITH' THEN 2 
            WHEN 'REPORTS_TO' THEN 1.5 
            ELSE 1 END) AS relationStrength
   RETURN s.name, relationStrength, degree
   ORDER BY relationStrength DESC
   ```

5. **集成沟通记录**
   ```cypher
   // 创建沟通记录节点
   CREATE (:PM_Communication {
     id: "comm_001",
     date: "2023-07-15",
     type: "会议|邮件|电话",
     summary: "讨论报表需求变更",
     participants: ["张明", "王总"]
   });
   
   // 关联干系人和任务
   MATCH (c:PM_Communication {id: "comm_001"})
   MATCH (s:PM_Stakeholder {name: "王总"})
   MATCH (t:PM_Task {id: "task_1003"})
   CREATE (c)-[:WITH_STAKEHOLDER]->(s),
          (c)-[:ABOUT_TASK]->(t)
   ```

通过增加干系人图谱信息，项目管理系统可以实现：
- 完整的利益相关方分析
- 决策影响路径可视化
- 沟通责任矩阵自动生成
- 干系人满意度预测
- 组织关系风险预警

这种扩展使项目管理从单纯的"任务-资源"管理升级为全面的"人-任务-关系"生态系统管理，特别适用于复杂项目和组织环境。