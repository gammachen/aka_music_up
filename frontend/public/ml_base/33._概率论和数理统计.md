```python
# %matplotlib notebook
from scipy import stats
import matplotlib.pyplot as plt
import numpy as np
import pandas as pd
import statsmodels.api as sm
plt.rcParams['font.sans-serif'] = ['SimHei'] #指定默认字体   
plt.rcParams['axes.unicode_minus'] = False #解决保存图像是负号'-'显示为方块的问题
# from IPython.core.interactiveshell import InteractiveShell
# InteractiveShell.ast_node_interactivity = "all"
```

# 伯努利分布（Bernoulli Distribution）


```python
fs=16
```


```python
fig,ax=plt.subplots(1,1)
p=.8
x=[0,1]
plt.bar(x,stats.bernoulli.pmf(x,p),label='伯努利-PMF',alpha=.7,width=.2)
plt.title('伯努利-概率质量分布',fontsize=fs)
plt.xlabel('随机变量',fontsize=fs)
plt.ylabel('概率',fontsize=fs)
plt.legend()
```




    <matplotlib.legend.Legend at 0x24dcc70f7b8>




    
![png](33._%E6%A6%82%E7%8E%87%E8%AE%BA%E5%92%8C%E6%95%B0%E7%90%86%E7%BB%9F%E8%AE%A1_files/33._%E6%A6%82%E7%8E%87%E8%AE%BA%E5%92%8C%E6%95%B0%E7%90%86%E7%BB%9F%E8%AE%A1_3_1.png)
    


# 二项分布


```python
fig,ax=plt.subplots(1,1)
n,p=20,.6
binom=stats.binom(n,p)
x=np.arange(binom.ppf(0.0001),binom.ppf(.9999))
plt.bar(x,binom.pmf(x),label='PMF',alpha=.7,width=.2)
plt.title('PMF of 二项分布，B(n={},p={})'.format(n,p),fontsize=fs)
plt.xlabel('实验次数',fontsize=fs)
plt.ylabel('概率',fontsize=fs)
plt.legend(fontsize=fs)
```




    <matplotlib.legend.Legend at 0x24dcc7c66a0>




    
![png](33._%E6%A6%82%E7%8E%87%E8%AE%BA%E5%92%8C%E6%95%B0%E7%90%86%E7%BB%9F%E8%AE%A1_files/33._%E6%A6%82%E7%8E%87%E8%AE%BA%E5%92%8C%E6%95%B0%E7%90%86%E7%BB%9F%E8%AE%A1_5_1.png)
    


# 泊松分布


```python
fig, ax = plt.subplots(1, 1)
mu=10
poisson = stats.poisson(mu)
x=np.arange(poisson.ppf(0.0001),poisson.ppf(.9999))
plt.bar(x,poisson.pmf(x),label='pmf',alpha=0.7,width=.2)
plt.title('PMF of 泊松分布，Poisson(mu={})'.format(mu),fontsize=fs)
plt.xlabel('平均发生次数',fontsize=fs)
plt.ylabel('概率',fontsize=fs)
plt.legend(fontsize=fs)
plt.subplots_adjust(wspace=0,hspace=.7)
```


    
![png](33._%E6%A6%82%E7%8E%87%E8%AE%BA%E5%92%8C%E6%95%B0%E7%90%86%E7%BB%9F%E8%AE%A1_files/33._%E6%A6%82%E7%8E%87%E8%AE%BA%E5%92%8C%E6%95%B0%E7%90%86%E7%BB%9F%E8%AE%A1_7_0.png)
    


# 二项分布和其他分布的关系


```python
fig, ax = plt.subplots(3, 1,sharex=True,sharey=True,figsize=(6,7))
n,p=1000000,.00001
binom=stats.binom(n,p)
bx=np.arange(binom.ppf(0.0001),binom.ppf(.9999))
plt.subplot(3, 1, 1)
plt.bar(bx,binom.pmf(x),label='pmf',alpha=0.7,width=.2)
plt.title('PMF of 二项分布，B(n={},p={})'.format(n,p),fontsize=fs)
plt.xlabel('实验次数',fontsize=fs)
# plt.ylabel('概率',fontsize=fs)
plt.legend()

mu=10
poisson = stats.poisson(mu)
px=np.arange(poisson.ppf(0.0001),poisson.ppf(.9999))
plt.subplot(3, 1, 2)
plt.bar(px,poisson.pmf(x),label='pmf',alpha=0.7,width=.2)
plt.title('PMF of 泊松分布，Poisson(mu={})'.format(mu),fontsize=fs)
plt.xlabel('平均发生次数',fontsize=fs)
# plt.ylabel('概率',fontsize=fs)
plt.legend()
plt.subplots_adjust(wspace=0,hspace=.7)

plt.subplot(3, 1, 3)
plt.plot(bx,binom.pmf(x),'.',label='二项分布')
plt.plot(px,poisson.pmf(x),label='泊松分布')
plt.title('二项分布和泊松分布',fontsize=fs)
plt.legend()
```




    <matplotlib.legend.Legend at 0x24dcca36ba8>




    
![png](33._%E6%A6%82%E7%8E%87%E8%AE%BA%E5%92%8C%E6%95%B0%E7%90%86%E7%BB%9F%E8%AE%A1_files/33._%E6%A6%82%E7%8E%87%E8%AE%BA%E5%92%8C%E6%95%B0%E7%90%86%E7%BB%9F%E8%AE%A1_9_1.png)
    


# 自定义分布函数


```python
xk=np.arange(7)
pk=[.1,.2,.3,.1,.1,.0,.2]
custm = stats.rv_discrete(name='custm', values=(xk, pk))
fig, ax = plt.subplots(1, 1)
plt.bar(xk,custm.pmf(xk),alpha=0.7,width=.2)
plt.title('PMF-概率质量分布图',fontsize=fs)
plt.xlabel('随机变量',fontsize=fs)
plt.ylabel('概率',fontsize=fs)
```




    Text(0,0.5,'概率')




    
![png](33._%E6%A6%82%E7%8E%87%E8%AE%BA%E5%92%8C%E6%95%B0%E7%90%86%E7%BB%9F%E8%AE%A1_files/33._%E6%A6%82%E7%8E%87%E8%AE%BA%E5%92%8C%E6%95%B0%E7%90%86%E7%BB%9F%E8%AE%A1_11_1.png)
    


# 经验分布函数


```python
xk=np.arange(7)
pk=[.1,.2,.3,.1,.1,.0,.2]
custm = stats.rv_discrete(name='custm', values=(xk, pk))
X1 = custm.rvs(size=20)  # 第一次抽样
X2 = custm.rvs(size=200)  # 第二次抽样
val1, cnt1 = np.unique(X1, return_counts=True)
val2, cnt2 = np.unique(X2, return_counts=True)
pmf_X1 = cnt1 / len(X1)
pmf_X2 = cnt2 / len(X2)
fig, ax = plt.subplots(1, 1)
plt.plot(xk,custm.pmf(xk),label='PMF')
plt.plot(val1,pmf_X1,label='第一次抽样')
plt.plot(val2,pmf_X2,label='第二次抽样')
plt.title('PMF-概率质量分布图',fontsize=fs)
plt.xlabel('随机变量',fontsize=fs)
plt.ylabel('概率',fontsize=fs)
plt.legend()
```




    <matplotlib.legend.Legend at 0x24dccb44240>




    
![png](33._%E6%A6%82%E7%8E%87%E8%AE%BA%E5%92%8C%E6%95%B0%E7%90%86%E7%BB%9F%E8%AE%A1_files/33._%E6%A6%82%E7%8E%87%E8%AE%BA%E5%92%8C%E6%95%B0%E7%90%86%E7%BB%9F%E8%AE%A1_13_1.png)
    


# 均匀分布


```python
x=np.linspace(-1,2)
df=pd.DataFrame(data=stats.uniform.cdf(x),index=x,columns=['CDF'])
df.plot(title='CDF of uniform dist',legend=True,fontsize=fs)
```




    <matplotlib.axes._subplots.AxesSubplot at 0x24dcca72b70>




    
![png](33._%E6%A6%82%E7%8E%87%E8%AE%BA%E5%92%8C%E6%95%B0%E7%90%86%E7%BB%9F%E8%AE%A1_files/33._%E6%A6%82%E7%8E%87%E8%AE%BA%E5%92%8C%E6%95%B0%E7%90%86%E7%BB%9F%E8%AE%A1_15_1.png)
    



```python
# 均匀分布，在实际的定义中有两个参数，分布定义域去加你的起点和终点【a,b】
a,b=8,16
unif=stats.uniform(loc=a,scale=b-a)# loc:该分布的起点，scale：区间的长度，相当于b-a
u_rvs=np.linspace(unif.ppf(.01),unif.ppf(.99),100)
u_pdf=unif.pdf(u_rvs)
df=pd.DataFrame(data=u_pdf,index=u_rvs,columns=['pdf of unif'])
df.plot(fontsize=fs,title='pdf of unif({},{})'.format(a,b))
r=unif.rvs(1000)
plt.hist(r,histtype='bar',density=True,alpha=.2,rwidth=.8,label='rvs of unif({},{})'.format(a,b))
plt.legend(loc='best')
```




    <matplotlib.legend.Legend at 0x24dccc4a630>




    
![png](33._%E6%A6%82%E7%8E%87%E8%AE%BA%E5%92%8C%E6%95%B0%E7%90%86%E7%BB%9F%E8%AE%A1_files/33._%E6%A6%82%E7%8E%87%E8%AE%BA%E5%92%8C%E6%95%B0%E7%90%86%E7%BB%9F%E8%AE%A1_16_1.png)
    


# 指数分布


```python
loc,la=0,10
exp=stats.expon(loc=loc,scale=1/la)
# 指数分布，按照定义只有一个参数lambda，这里的scale = 1/lambda
# loc: 定义域的左端点，相当于将整体分布沿x轴平移loc
# scale: lambda的倒数，loc + scale表示该分布的均值，scale^2表示该分布的方差
exp_rvs=np.linspace(exp.ppf(.001),exp.ppf(.999),num=100)
exp_pdf=exp.pdf(exp_rvs)
df=pd.DataFrame(data=exp_pdf,index=exp_rvs,columns=['pdf of exp'])
df.plot(fontsize=fs,title='pdf of exp({})'.format(la))
r=exp.rvs(size=1000)
plt.hist(r,histtype='bar',density=True,alpha=.3,rwidth=.8,label='rvs of exp')
plt.legend()
```




    <matplotlib.legend.Legend at 0x24dcca920b8>




    
![png](33._%E6%A6%82%E7%8E%87%E8%AE%BA%E5%92%8C%E6%95%B0%E7%90%86%E7%BB%9F%E8%AE%A1_files/33._%E6%A6%82%E7%8E%87%E8%AE%BA%E5%92%8C%E6%95%B0%E7%90%86%E7%BB%9F%E8%AE%A1_18_1.png)
    



```python
plt.figure()
loc=0
las=[.5,1,2]
for la in las:
    exp=stats.expon(loc=loc,scale=1/la)
    exp_rvs=np.linspace(exp.ppf(.001),exp.ppf(.999),num=100)
    exp_pdf=exp.pdf(exp_rvs)
    plt.plot(exp_rvs,exp_pdf,label='pdf of exp({})'.format(la))
plt.title('pdf of exp',fontsize=fs)
plt.xticks(fontsize=fs)
plt.yticks(fontsize=fs)
plt.legend()
```




    <matplotlib.legend.Legend at 0x24dcc87fc50>




    
![png](33._%E6%A6%82%E7%8E%87%E8%AE%BA%E5%92%8C%E6%95%B0%E7%90%86%E7%BB%9F%E8%AE%A1_files/33._%E6%A6%82%E7%8E%87%E8%AE%BA%E5%92%8C%E6%95%B0%E7%90%86%E7%BB%9F%E8%AE%A1_19_1.png)
    


# 正态分布


```python
mu,sigma=0,1
norm_rvs=np.linspace(-3,3)
norm_cdf=stats.norm.cdf(x=norm_rvs,loc=mu,scale=sigma)
norm_pdf=stats.norm.pdf(x=norm_rvs,loc=mu,scale=sigma)
pf=pd.DataFrame(data=np.array([norm_cdf,norm_pdf]).T,index=norm_rvs,columns=['cdf-Φ of norm','pdf of norm'])
pf.plot(fontsize=fs,title='norm({},{})'.format(mu,sigma))
```




    <matplotlib.axes._subplots.AxesSubplot at 0x24dcc90a240>




    
![png](33._%E6%A6%82%E7%8E%87%E8%AE%BA%E5%92%8C%E6%95%B0%E7%90%86%E7%BB%9F%E8%AE%A1_files/33._%E6%A6%82%E7%8E%87%E8%AE%BA%E5%92%8C%E6%95%B0%E7%90%86%E7%BB%9F%E8%AE%A1_21_1.png)
    



```python
plt.figure()
norms=[
    (0,1),
    (0,.5),
    (0,2),
    (1,1)
]
for la in norms:
    norm=stats.norm(loc=la[0],scale=la[1])
    norm_rvs=np.linspace(norm.ppf(1e-5),norm.ppf(.99999),num=100)
    norm_pdf=norm.pdf(norm_rvs)
    plt.plot(norm_rvs,norm_pdf,label='pdf of norm({},{})'.format(*la))
plt.title('pdf of norm',fontsize=fs)
plt.xticks(fontsize=fs)
plt.yticks(fontsize=fs)
plt.legend()
```




    <matplotlib.legend.Legend at 0x24dccd57d30>




    
![png](33._%E6%A6%82%E7%8E%87%E8%AE%BA%E5%92%8C%E6%95%B0%E7%90%86%E7%BB%9F%E8%AE%A1_files/33._%E6%A6%82%E7%8E%87%E8%AE%BA%E5%92%8C%E6%95%B0%E7%90%86%E7%BB%9F%E8%AE%A1_22_1.png)
    


# 样本均值的计算


```python
x=np.random.randint(low=1,high=100,size=19)
x# 样本
x.mean()
stats.gmean(x)
```




    29.643327586801306



# 样本方差的计算


```python
# 样本
x=np.random.randint(low=0,high=100,size=10)
x
# 计算方差
# 直接使用样本二阶中心距计算方差，分母为n
np.var(x)# 默认，ddof=0
# 使用总体方差的无偏估计计算方差，分母为n-1
np.var(x,ddof=1)# 使用ddof设置自由度的偏移量
# 计算标准差
np.std(x,ddof=0) # 使用ddof设置自由度的偏移量
np.std(x,ddof=1)
```




    27.92072109861539



# 样本均值的期望和方差


```python
def mean_and_std_of_sample_mean(ss=[], group_n=100):
    """
    不同大小样本均值的均值以及标准差
    """
    norm_dis = stats.norm(0, 2)  # 定义一个均值为0，标准差为2的正态分布
    for n in ss:
        sample_mean = []  # 收集每次取样的样本均值
        for i in range(group_n):
            sample = norm_dis.rvs(n)  # 取样本量为n的样本
            sample_mean.append(np.mean(sample))  # 计算该组样本的均值
        print(np.std(sample_mean), np.mean(sample_mean))

sample_size = [1, 4, 9, 16, 100]  # 每组试验的样本量
group_num = 10000
mean_and_std_of_sample_mean(ss=sample_size, group_n=group_num)
```

    1.9962181572420852 -0.009893428030383492
    1.0025071548725204 -0.026477450961542873
    0.6672785103744027 -0.007174587640266762
    0.5095519820304182 0.005073027085772418
    0.2007517067505913 0.0022666081914324804


# 大数定理
模拟投掷硬币


```python
import random
nums=2**np.arange(4,16+1)
radios=[]
for n in nums:
    numheads=0
    for i in range(n):
        if random.random()>.5:
            numheads+=1
    radios.append(numheads/(n-numheads))
plt.figure()
plt.title("正反面的比率")
plt.xlabel('单次实验抽样次数')
plt.ylabel('比率')
plt.plot(nums,radios)
plt.hlines(1,0,nums[-1],linestyles=':',colors='r')
plt.show()
```


    
![png](33._%E6%A6%82%E7%8E%87%E8%AE%BA%E5%92%8C%E6%95%B0%E7%90%86%E7%BB%9F%E8%AE%A1_files/33._%E6%A6%82%E7%8E%87%E8%AE%BA%E5%92%8C%E6%95%B0%E7%90%86%E7%BB%9F%E8%AE%A1_30_0.png)
    


# N重伯努利分布-二项分布


```python
n,p=100,.5
b=stats.binom(n,p)
b_rvs=np.arange(b.ppf(.0001),b.ppf(.9999))
plt.figure()
plt.plot(b_rvs,b.pmf(b_rvs),'bo',label='pmf of B({},{})'.format(n,p))
plt.title('pmf of B({},{})'.format(n,p))
plt.legend()
```




    <matplotlib.legend.Legend at 0x24dcce149e8>




    
![png](33._%E6%A6%82%E7%8E%87%E8%AE%BA%E5%92%8C%E6%95%B0%E7%90%86%E7%BB%9F%E8%AE%A1_files/33._%E6%A6%82%E7%8E%87%E8%AE%BA%E5%92%8C%E6%95%B0%E7%90%86%E7%BB%9F%E8%AE%A1_32_1.png)
    


# N重伯努利分布-近似正态分布


```python
mu,sigma=100*.5,(100*.5*(1-.5))
norm=stats.norm(loc=mu,scale=sigma)
norm_rvs=np.linspace(-20,120)
plt.figure()
plt.plot(norm_rvs,norm.pdf(norm_rvs),label='pdf of N({},{})'.format(mu,sigma))
plt.title('pdf of N({},{})'.format(mu,sigma))
plt.legend()
```




    <matplotlib.legend.Legend at 0x24dcce85278>




    
![png](33._%E6%A6%82%E7%8E%87%E8%AE%BA%E5%92%8C%E6%95%B0%E7%90%86%E7%BB%9F%E8%AE%A1_files/33._%E6%A6%82%E7%8E%87%E8%AE%BA%E5%92%8C%E6%95%B0%E7%90%86%E7%BB%9F%E8%AE%A1_34_1.png)
    


# 模拟服从各分布的随机变量和


```python
# 定义分布类型
drv,crv=0,1# 离散型分布，连续型分布
# 绘制连续型随机变量和的分布
def  sampling2pdf(plt,n,dist,t=10000):
    """
    :param plt: 为绘制对象
    :param n: 单次实验的抽样次数
    :param dist:独立同分布的分布对象
    :param t:独立同分布的实验次数
    """
    sum_of_samples=np.zeros(t)
    for i in range(t):
        samples=dist.rvs(size=n)# 抽样次数
        sum_of_samples[i]=np.sum(samples)
    plt.hist(sum_of_samples,density=True,bins=100,label='{}RVS'.format(n),color='#348ABD')
# 绘制离散型随机变量和的分布
def sampling2pmf(plt,n,dist,t=10000):
    sum_of_samples=np.zeros(t)
    for i in range(t):
        samples=dist.rvs(size=n)
        sum_of_samples[i]=np.sum(samples)
    val,cnt=np.unique(sum_of_samples,return_counts=True) # 独立同分布的随机变量和的值以及对应的个数
    pmf=cnt/len(sum_of_samples)
    plt.vlines(val,0,pmf,linestyles='-',lw=3,color='#348ABD')
def plot(n,dist,subplot,plt,t,dist_name,dist_type):
    """
    :param dist_name: 分布名称
    :param dist_type: 分布类型
    """
    plt.subplot(subplot)
    sampling2pmf(plt=plt,n=n,dist=dist,t=t) if dist_type==drv else sampling2pdf(plt,n,dist,t)
    # 正态分布
    mu,sigma=n*dist.mean(),(n*dist.var())**.5
    norm=stats.norm(loc=mu,scale=sigma)
    norm_x=np.linspace(mu-3*sigma,mu+3*sigma,t)
    norm_pdf=norm.pdf(norm_x)
    plt.plot(norm_x,norm_pdf,'r--',alpha=.5,label='N(${0:.0f},{1:.2f}^2$)'.format(mu,sigma))
    plt.legend(loc='upper left',prop={"size":6})
size=[
(1,231),
(4,232),
(20,233),
(80,234),
(200,235),
(1000,236),
]# 抽样次数,画布位置
t=10000# 实验次数
# dist_name,dist_type='伯努利',drv
# dist=stats.bernoulli(p=.99)# 定义一个伯努利分布
# dist_name,dist_type='二项分布',drv
# dist=stats.binom(n=20,p=.4)# 定义一个二项分布
dist_name,dist_type='均匀分布',crv
dist=stats.uniform(loc=3,scale=5-3)# 定义一个均匀分布
plt.figure(figsize=(8,4))
for i in size:
    plot(n=i[0],dist=dist,subplot=i[1],plt=plt,t=t,dist_name=dist_name,dist_type=dist_type)
plt.suptitle('t次{}实验的RVS和收敛于正态分布'.format(dist_name))
plt.subplots_adjust(wspace=.1,hspace=.1,left=0,right=1,top=.93,bottom=0.05)  
```


    
![png](33._%E6%A6%82%E7%8E%87%E8%AE%BA%E5%92%8C%E6%95%B0%E7%90%86%E7%BB%9F%E8%AE%A1_files/33._%E6%A6%82%E7%8E%87%E8%AE%BA%E5%92%8C%E6%95%B0%E7%90%86%E7%BB%9F%E8%AE%A1_36_0.png)
    


# 卡方分布


```python
plt.figure()
df=20# 卡方分布的自由度
chi2=stats.chi2(df=df)
chi2_x=np.linspace(chi2.ppf(1e-3),chi2.ppf(.999),200)
plt.plot(chi2_x,chi2.pdf(chi2_x),'r-',lw=5,alpha=.6,label=r'PDF of $\chi^2$({})'.format(df))
chi2_rvs=chi2.rvs(size=10000)
plt.hist(chi2_rvs,density=True,histtype='stepfilled',alpha=.2)
plt.ylabel("概率")
plt.title(r'PDF of $\chi^2$({})'.format(df))
plt.subplots_adjust(wspace=.1,hspace=.1,left=0.1,right=1,top=.93,bottom=0.05)  
plt.legend()
```




    <matplotlib.legend.Legend at 0x24dce6f9da0>




    
![png](33._%E6%A6%82%E7%8E%87%E8%AE%BA%E5%92%8C%E6%95%B0%E7%90%86%E7%BB%9F%E8%AE%A1_files/33._%E6%A6%82%E7%8E%87%E8%AE%BA%E5%92%8C%E6%95%B0%E7%90%86%E7%BB%9F%E8%AE%A1_38_1.png)
    



```python
plt.figure(figsize=(8,4))
dfs=[
(1,(0.65, 0.9999999), ),
(4,(0.000001,0.999999), ),
(10,(0.000001, 0.99999), ),
(20,(0.00000001, 0.9999), ),
]# 卡方自由度
for df,(l,r) in dfs:
    chi2=stats.chi2(df=df)
    chi2_x=np.linspace(chi2.ppf(l),chi2.ppf(r),100)
    plt.plot(chi2_x,chi2.pdf(chi2_x),alpha=0.6, label=r'PDF of $\chi^2$({})'.format(df))
plt.ylabel('概率')
plt.title(r'PDF of $\chi^2$')
plt.subplots_adjust(wspace=.1,hspace=.1,left=0.1,right=1,top=.93,bottom=0.05)  
plt.legend()
```




    <matplotlib.legend.Legend at 0x24dce77ef60>




    
![png](33._%E6%A6%82%E7%8E%87%E8%AE%BA%E5%92%8C%E6%95%B0%E7%90%86%E7%BB%9F%E8%AE%A1_files/33._%E6%A6%82%E7%8E%87%E8%AE%BA%E5%92%8C%E6%95%B0%E7%90%86%E7%BB%9F%E8%AE%A1_39_1.png)
    


# t分布


```python
plt.figure()
df=20# t分布的自由度
t=stats.t(df=df)
t_x=np.linspace(t.ppf(.001),t.ppf(.999),200)
plt.plot(t_x,t.pdf(t_x), 'r-',lw=5, alpha=0.6, label=r'PDF of t({})'.format(df))
t_rvs=t.rvs(size=10000)
plt.hist(t_rvs,density=True, histtype='stepfilled', alpha=0.2)
plt.title(r'PDF of t({})'.format(df))
plt.ylabel('概率')
plt.legend()
plt.subplots_adjust(wspace=.1,hspace=.1,left=0.1,right=1,top=.93,bottom=0.05)  
```


    
![png](33._%E6%A6%82%E7%8E%87%E8%AE%BA%E5%92%8C%E6%95%B0%E7%90%86%E7%BB%9F%E8%AE%A1_files/33._%E6%A6%82%E7%8E%87%E8%AE%BA%E5%92%8C%E6%95%B0%E7%90%86%E7%BB%9F%E8%AE%A1_41_0.png)
    



```python
plt.figure(figsize=(8,4))
dfs=[
(1,(0.04, 0.96), ),
(4,(0.001,0.999), ),
(10,(0.001,0.999), ),
(20,(0.001,0.999), ),
]
n=stats.norm()
n_x=np.linspace(n.ppf(0.000001),n.ppf(0.999999),1000)
plt.plot(n_x, n.pdf(n_x), label=r'N(0, 1)')
for df,p in dfs:
    t=stats.t(df=df)
    t_x=np.linspace(t.ppf(p[0]),t.ppf(p[1]),1000)
    plt.plot(t_x,t.pdf(t_x), label=r'PDF of t({})'.format(df))
plt.ylabel('概率')
plt.title(r'PDF of t')
plt.subplots_adjust(wspace=.1,hspace=.1,left=0.1,right=1,top=.93,bottom=0.05)  
plt.legend()
```




    <matplotlib.legend.Legend at 0x24dce85b710>




    
![png](33._%E6%A6%82%E7%8E%87%E8%AE%BA%E5%92%8C%E6%95%B0%E7%90%86%E7%BB%9F%E8%AE%A1_files/33._%E6%A6%82%E7%8E%87%E8%AE%BA%E5%92%8C%E6%95%B0%E7%90%86%E7%BB%9F%E8%AE%A1_42_1.png)
    


# F分布


```python
plt.figure()
dfn,dfd=4,10#第一自由度和第二自由度
f=stats.f(dfn=dfn,dfd=dfd)
f_x=np.linspace(f.ppf(.001),f.ppf(.999),200)
plt.plot(f_x,f.pdf(f_x), 'r-',lw=5, alpha=0.6, label=r'PDF of F({}, {})'.format(dfn, dfd))
f_rvs=f.rvs(size=10000)
plt.hist(f_rvs,density=True, histtype='stepfilled', alpha=0.2)
plt.title(r'PDF of F({}, {})'.format(dfn, dfd))
plt.ylabel('概率')
plt.legend()
plt.subplots_adjust(wspace=.1,hspace=.1,left=0.1,right=1,top=.93,bottom=0.05)  
```


    
![png](33._%E6%A6%82%E7%8E%87%E8%AE%BA%E5%92%8C%E6%95%B0%E7%90%86%E7%BB%9F%E8%AE%A1_files/33._%E6%A6%82%E7%8E%87%E8%AE%BA%E5%92%8C%E6%95%B0%E7%90%86%E7%BB%9F%E8%AE%A1_44_0.png)
    



```python
plt.figure(figsize=(8,4))
dfs=[
    ((1,30),(.2,.99)),
    ((30,5),(.00001,.99)),
    ((30,30),(.00001,.999)),
    ((30,100),(.0001,.999)),
    ((100,100),(.0001,.9999)),
]# F分布的自由度
for (dfn,dfd),(l,r) in dfs:
    f=stats.f(dfn=dfn,dfd=dfd)
    f_x=np.linspace(f.ppf(l),f.ppf(r),200)
    plt.plot(f_x,f.pdf(f_x), label=r'PDF of F({}, {})'.format(dfn, dfd))
plt.ylabel('概率')
plt.title(r'PDF of F')
plt.subplots_adjust(wspace=.1,hspace=.1,left=0.1,right=1,top=.93,bottom=0.05)  
plt.legend()
```




    <matplotlib.legend.Legend at 0x24dccd57550>




    
![png](33._%E6%A6%82%E7%8E%87%E8%AE%BA%E5%92%8C%E6%95%B0%E7%90%86%E7%BB%9F%E8%AE%A1_files/33._%E6%A6%82%E7%8E%87%E8%AE%BA%E5%92%8C%E6%95%B0%E7%90%86%E7%BB%9F%E8%AE%A1_45_1.png)
    


# 三大抽样分布与标准正态分布


```python
ds=[
    (stats.norm(loc=0,scale=1),r'N(0, 1)'),
    (stats.chi2(df=4),r'$\chi^2$(4)'),
    (stats.t(df=5),r't(5)'),
    (stats.f(dfn=30, dfd=5),r'F(30, 5)')
]
plt.figure(figsize=(8,4))
for d,l in ds:
    x=np.linspace(d.ppf(.001),d.ppf(.999),1000)
    plt.plot(x,d.pdf(x), label=l)
plt.ylabel('概率')
plt.title(r'PDF of 三大分布')
plt.subplots_adjust(wspace=.1,hspace=.1,left=0.1,right=1,top=.93,bottom=0.05)  
plt.legend()
```




    <matplotlib.legend.Legend at 0x24dce5a79b0>




    
![png](33._%E6%A6%82%E7%8E%87%E8%AE%BA%E5%92%8C%E6%95%B0%E7%90%86%E7%BB%9F%E8%AE%A1_files/33._%E6%A6%82%E7%8E%87%E8%AE%BA%E5%92%8C%E6%95%B0%E7%90%86%E7%BB%9F%E8%AE%A1_47_1.png)
    


# python 回归分析

一元线性回归实验
抽样数据


```python
nsample=100
X=np.linspace(0,10,100)
beta=[1,2]
e=np.random.normal(size=nsample)
X=sm.add_constant(X)
y=np.dot(X,beta)+e
```

抽样获得解释变量X和被解释变量y


```python
plt.scatter(x=X[:,1],y=y)
```




    <matplotlib.collections.PathCollection at 0x24dce635ac8>




    
![png](33._%E6%A6%82%E7%8E%87%E8%AE%BA%E5%92%8C%E6%95%B0%E7%90%86%E7%BB%9F%E8%AE%A1_files/33._%E6%A6%82%E7%8E%87%E8%AE%BA%E5%92%8C%E6%95%B0%E7%90%86%E7%BB%9F%E8%AE%A1_52_1.png)
    


通过绘制散点图，确定样本的回归函数形式为$y=a+bx$


```python
model=sm.OLS(exog=X,endog=y)
results=model.fit()
print(results.summary())
```

                                OLS Regression Results                            
    ==============================================================================
    Dep. Variable:                      y   R-squared:                       0.973
    Model:                            OLS   Adj. R-squared:                  0.973
    Method:                 Least Squares   F-statistic:                     3536.
    Date:                Sat, 13 Oct 2018   Prob (F-statistic):           1.05e-78
    Time:                        15:32:44   Log-Likelihood:                -138.02
    No. Observations:                 100   AIC:                             280.0
    Df Residuals:                      98   BIC:                             285.3
    Df Model:                           1                                         
    Covariance Type:            nonrobust                                         
    ==============================================================================
                     coef    std err          t      P>|t|      [0.025      0.975]
    ------------------------------------------------------------------------------
    const          1.1259      0.193      5.836      0.000       0.743       1.509
    x1             1.9818      0.033     59.464      0.000       1.916       2.048
    ==============================================================================
    Omnibus:                        2.349   Durbin-Watson:                   2.181
    Prob(Omnibus):                  0.309   Jarque-Bera (JB):                2.343
    Skew:                          -0.357   Prob(JB):                        0.310
    Kurtosis:                       2.771   Cond. No.                         11.7
    ==============================================================================
    
    Warnings:
    [1] Standard Errors assume that the covariance matrix of the errors is correctly specified.


多元回归分析的案例介绍


```python
# 仿真抽样，在实际中，x和y是抽样所得
nsample=100
x=np.linspace(0,10,100)
X=np.column_stack((x,x**2))
beta=[1,2,10]
e=np.random.normal(size=nsample)
X=sm.add_constant(X)
y=np.dot(X,beta)+e
```


```python
results=sm.OLS(exog=X,endog=y).fit()
print(results.summary())
```

                                OLS Regression Results                            
    ==============================================================================
    Dep. Variable:                      y   R-squared:                       1.000
    Model:                            OLS   Adj. R-squared:                  1.000
    Method:                 Least Squares   F-statistic:                 6.386e+06
    Date:                Sat, 13 Oct 2018   Prob (F-statistic):          5.08e-249
    Time:                        15:32:44   Log-Likelihood:                -125.20
    No. Observations:                 100   AIC:                             256.4
    Df Residuals:                      97   BIC:                             264.2
    Df Model:                           2                                         
    Covariance Type:            nonrobust                                         
    ==============================================================================
                     coef    std err          t      P>|t|      [0.025      0.975]
    ------------------------------------------------------------------------------
    const          0.9069      0.253      3.589      0.001       0.405       1.408
    x1             2.0281      0.117     17.364      0.000       1.796       2.260
    x2            10.0010      0.011    884.901      0.000       9.979      10.023
    ==============================================================================
    Omnibus:                        5.324   Durbin-Watson:                   1.857
    Prob(Omnibus):                  0.070   Jarque-Bera (JB):                7.075
    Skew:                          -0.167   Prob(JB):                       0.0291
    Kurtosis:                       4.259   Cond. No.                         144.
    ==============================================================================
    
    Warnings:
    [1] Standard Errors assume that the covariance matrix of the errors is correctly specified.

